{{- /*
    * Generate a sidebar for a column of articles.
    * It will start form top level section and iterate through all sections
    * and pages.
    * Current selected page will be marked as active.
    */ -}}
{{- $Current := .Page -}}
{{- $Root := .Page.FirstSection -}}


<details open class="w-full menu bg-base-200">
    <summary><a href="{{ $Root.RelPermalink }}" class="{{ if eq $Current.RelPermalink $Root.RelPermalink -}} menu-active{{- end -}}">{{ $Root.Title }}</a></summary>
    {{- template "visit-section" (dict "selected" $Current "current" $Root) -}}
</details>

{{- define "visit-section" -}}
{{ $selected := .selected }}
{{ $current := .current }}
<ul >
    {{- range $current.Pages.ByWeight -}}
    {{- if .IsPage -}}
        <li><a href="{{ .RelPermalink }}" class="{{ if eq $selected.RelPermalink .RelPermalink -}} menu-active{{- end -}}">{{ cond (.Params.ColumnTitle) (.Params.ColumnTitle) (.Title) }}</a></li>
    {{- else -}}
        <li>
            <details open>
                <summary><a href="{{ .RelPermalink }}" class="{{ if eq $selected.RelPermalink .RelPermalink -}} menu-active{{- end -}}">{{ .Title }}</a></summary>
                {{- template "visit-section" (dict "selected" $selected "current" .) -}}
            </details>
        </li>
        {{- end -}}
    {{- end -}}
</ul>
{{- end -}}
